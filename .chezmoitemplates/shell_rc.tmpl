# Environement
{{- if lookPath "nvim" }}
export EDITOR=nvim
{{- else if lookPath "vim" }}
export EDITOR=vim
{{- end }}

for file in $(find "${HOME}/.config/shell" -name "*.sh"); do
    #shellcheck source=/dev/null
    source "${file}"
done

# Chezmoi
{{ if lookPath "chezmoi" }}
{{ output "chezmoi" "completion" .shell }}
{{ end }}

# Deno
{{ if lookPath "deno" }}
{{ output "deno" "completions" .shell }}
{{ end }}

# Rustup
{{ if lookPath "rustup" }}
{{ output "rustup" "completions" .shell }}
{{ end }}

# uv
{{ if lookPath "uv" }}
{{ output "uv" "generate-shell-completion" .shell }}
{{ end }}

# Volta
{{ if lookPath "volta" }}
{{ output "volta" "completions" .shell }}
{{ end }}

# Zellij
{{ if lookPath "zellij" }}
{{ output "zellij" "setup" "--generate-completion" .shell }}
{{ end }}

# Shell Framework
{{ if eq .shell "bash" }}
{{  if and (lookPath "starship") (eq .bash "starship") }}
{{      output "starship" "init" "bash" }}
starship_precmd_user_func="set-window-title"
{{  else if and (lookPath "oh-my-posh") (eq .bash "oh-my-posh") }}
{{      output "oh-my-posh" "init" "bash" "--config" "~/.config/omp.toml" | replaceAllRegex "export POSH_SESSION_ID.+" "" }}
{{  end }}
{{ else if eq .shell "zsh" }}
{{  if and (lookPath "starship") (eq .zsh "starship") }}
{{      output "starship" "init" "zsh" }}
precmd_functions+=(set-window-title)
{{  else if and (lookPath "oh-my-posh") (eq .zsh "oh-my-posh") }}
{{      output "oh-my-posh" "init" "zsh" "--config" "~/.config/omp.toml" | replaceAllRegex "export POSH_SESSION_ID.+" "" }}
{{  else }}
# POWERLEVEL
source "$XDG_CONFIG_HOME/zsh/plugins/powerlevel10k/powerlevel10k.zsh-theme"
POWERLEVEL9K_DISABLE_CONFIGURATION_WIZARD=true
{{      include "dot_config/zsh/dot_p10k.zsh" }}
{{  end }}
{{ end }}

